const blurhash=function(e){let t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],r=e=>{let r=0;for(let $=0;$<e.length;$++){let n=e[$],o=t.indexOf(n);r=83*r+o}return r},$=(e,r)=>{var $="";for(let n=1;n<=r;n++)$+=t[Math.floor(Math.floor(e)/Math.pow(83,r-n)%83)];return $},n=e=>{let t=e/255;return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)},o=e=>{let t=Math.max(0,Math.min(1,e));return t<=.0031308?Math.round(3294.6*t+.5):Math.round((1.055*Math.pow(t,1/2.4)-.055)*255+.5)},l=e=>e<0?-1:1,a=(e,t)=>l(e)*Math.pow(Math.abs(e),t),f=e=>{if(!e||e.length<6)throw Error("The blurhash string must be at least 6 characters");let t=r(e[0]),$=Math.floor(t/9)+1,n=t%9+1;if(e.length!==4+2*n*$)throw Error(`blurhash length mismatch: length is ${e.length} but it should be ${4+2*n*$}`)},h=e=>[n(e>>16),n(e>>8&255),n(255&e)],_=(e,t)=>{let r=[a((Math.floor(e/361)-9)/9,2)*t,a((Math.floor(e/19)%19-9)/9,2)*t,a((e%19-9)/9,2)*t];return r},g=(e,t,r,$)=>{let o=0,l=0,a=0,f=4*t;for(let h=0;h<t;h++)for(let _=0;_<r;_++){let g=$(h,_);o+=g*n(e[4*h+0+_*f]),l+=g*n(e[4*h+1+_*f]),a+=g*n(e[4*h+2+_*f])}let i=1/(t*r);return[o*i,l*i,a*i]},i=e=>{let t=o(e[0]),r=o(e[1]),$=o(e[2]);return(t<<16)+(r<<8)+$},u=(e,t)=>{let r=Math.floor(Math.max(0,Math.min(18,Math.floor(9*a(e[0]/t,.5)+9.5)))),$=Math.floor(Math.max(0,Math.min(18,Math.floor(9*a(e[1]/t,.5)+9.5)))),n=Math.floor(Math.max(0,Math.min(18,Math.floor(9*a(e[2]/t,.5)+9.5))));return 361*r+19*$+n};return e.decodePromise=(t,r,$,n=1)=>new Promise((o,l)=>{o(e.decode(t,r,$,n))}),e.decode=(e,t,$,n=1)=>{f(e),n|=1;let l=r(e[0]),a=Math.floor(l/9)+1,g=l%9+1,i=r(e[1]),u=(i+1)/166,s=Array(g*a);for(let m=0;m<s.length;m++)if(0===m){let d=r(e.substring(2,6));s[m]=h(d)}else{let c=r(e.substring(4+2*m,6+2*m));s[m]=_(c,u*n)}let x=4*t,w=new Uint8ClampedArray(x*$);for(let C=0;C<$;C++)for(let I=0;I<t;I++){let b=0,F=0,p=0;for(let D=0;D<a;D++)for(let P=0;P<g;P++){let A=Math.cos(Math.PI*I*P/t)*Math.cos(Math.PI*C*D/$),v=s[P+D*g];b+=v[0]*A,F+=v[1]*A,p+=v[2]*A}let y=o(b),E=o(F),O=o(p);w[4*I+0+C*x]=y,w[4*I+1+C*x]=E,w[4*I+2+C*x]=O,w[4*I+3+C*x]=255}return w},e.encodePromise=(t,r,$,n,o)=>new Promise((l,a)=>{l(e.encode(t,r,$,n,o))}),e.encode=(e,t,r,n,o)=>{if(n<1||n>9||o<1||o>9)throw Error("BlurHash must have between 1 and 9 components");if(t*r*4!==e.length)throw Error("Width and height must match the pixels array");let l=[];for(let a=0;a<o;a++)for(let f=0;f<n;f++){let h=0==f&&0==a?1:2,_=g(e,t,r,(e,$)=>h*Math.cos(Math.PI*f*e/t)*Math.cos(Math.PI*a*$/r));l.push(_)}let s=l[0],m=l.slice(1),d="";d+=$(n-1+(o-1)*9,1);let c;if(m.length>0){let x=Math.floor(Math.max(0,Math.min(82,Math.floor(166*Math.max(...m.map(e=>Math.max(...e)))-.5))));c=(x+1)/166,d+=$(x,1)}else c=1,d+=$(0,1);return d+=$(i(s),4),m.forEach(e=>{d+=$(u(e,c),2)}),d},e.getImageData=e=>{let t=e.width,r=e.height,$=document.createElement("canvas"),n=$.getContext("2d");return $.width=t,$.height=r,n.width=t,n.height=r,n.drawImage(e,0,0),n.getImageData(0,0,t,r).data},e.drawImageDataOnNewCanvas=(e,t,r)=>{let $=document.createElement("canvas"),n=$.getContext("2d");return $.width=t,$.height=r,n.width=t,n.height=r,console.log("@@@imgdata",e),n.putImageData(new ImageData(e,t,r),0,0),$},e.getImageDataAsImageWithOnloadPromise=(t,r,$)=>new Promise((n,o)=>{e.getImageDataAsImage(t,r,$,(e,t)=>{n(t)})}),e.getImageDataAsImage=(t,r,$,n)=>{let o=e.drawImageDataOnNewCanvas(t,r,$),l=o.toDataURL(),a=new Image(r,$);return a.onload=e=>n(e,a),a.width=r,a.height=$,a.src=l,a},e}({});function blurHashToDataURL(e){if(!e)return;let t=blurhash.decode(e,32,32),r=parsePixels(t,32,32);return r}function parsePixels(e,t,r){let $=Array.from(e).map(e=>String.fromCharCode(e)).join(""),n=generatePng(t,r,$),o="undefined"!=typeof Buffer?Buffer.from(getPngArray(n)).toString("base64"):btoa(n);return"data:image/png;base64,"+o}function getPngArray(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function generatePng(e,t,r){let $=String.fromCharCode(120,1),n=[],o=String.fromCharCode(137,80,78,71,13,10,26,10);function l(e){return String.fromCharCode((4278190080&e)>>>24,(16711680&e)>>>16,(65280&e)>>>8,255&e)}function a(e,t,r){var $;let o=4294967295^function e(t,r){let $=4294967295,o;for(let l=0;l<r.length;l++)$=n[($^(o=r.charCodeAt(l)))&255]^$>>>8;return $}(4294967295,$=t+r);return l(e)+t+r+l(o)}let f=a(0,"IEND",""),h=function e(t,r){let $=l(t)+l(r)+"\b\x06\0\0\0";return a(13,"IHDR",$)}(e,t),_="",g;for(let i=0;i<r.length;i+=4*e){if(g="\0",Array.isArray(r))for(let u=0;u<4*e;u++)g+=String.fromCharCode(255&r[i+u]);else g+=r.substr(i,4*e);_+=g}let s=$+function e(t){let r="",$,n;for(let o=0;o<t.length;o+=65535)$=t.length-o,n="",$<=65535?n="\x01":($=65535,n="\0"),r+=n+String.fromCharCode(255&$,(65280&$)>>>8),r+=String.fromCharCode(255&~$,(65280&~$)>>>8),r+=t.substring(o,o+$);return r}(_)+l(function e(t){let r=1,$=0;for(let n=0;n<t.length;n++)$=($+(r=(r+t.charCodeAt(n))%65521))%65521;return $<<16|r}(_)),m=a(s.length,"IDAT",s);return o+h+m+f}